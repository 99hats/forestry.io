{{/* Renders feature blocks. E.g, homepage */}}
{{- with .feature -}}
  {{- if and .headline .textline -}}
  <section class="section{{ with .class }} {{ . }}{{- end -}}{{ if or (eq .direction "vertical") (eq .direction "tab") }} center{{ end }}">
    <div class="container">
      <div class="feature-block {{ .direction | default "ltr" }}">
        {{- if eq .direction "rtl" -}}{{- with .visual -}}
        <div class="feature-block--illu illu-shadow--left">
          {{- partial "cloudinary/image" (dict "pg" $.pg "preset" "feature" "image" .permalink "alt" (.alt | default .permalink)) }}
        </div>
        {{- end -}}{{- end -}}
        <div class="feature-block--copy">
          <h2 class="section--title">{{ markdownify .headline }}</h2>
          <div class="section--sub{{ if or (eq .direction "vertical") (eq .direction "tab") }} is-center{{ end }}">
            {{ markdownify .textline }}
          </div>
        </div>        
        {{- if eq .direction "tab" -}}
        {{- with .tabs -}}
        <div class="feature-block--nav-row" style="display:flex;flex-direction: row;">
        {{- range $index, $value := . -}}
            <div id="{{ .headline | urlize }}-nav" onclick="switchTab({{ .headline | urlize }})" class="feature-block--nav {{ if eq $index 0 }}active{{ end }}" style="">
              <h4>{{ .headline }}</h4>
            </div>
        {{- end -}}
        </div>
        <div class="feature-block--data">
        {{- range $index, $value := . -}}
            <div id="{{ .headline | urlize }}" class="feature-block--tab-data {{ if eq $index 0 }}active{{ end }}">
              <p>{{ .textline }}</p>
              {{- with .visual -}}
              <div class="feature-block--illu illu-shadow--left">
                {{- partial "cloudinary/image" (dict "pg" $.pg "preset" "feature" "image" .permalink "alt" (.alt | default .permalink)) }}
              </div>
              {{- end -}}
            </div>
        {{- end -}}{{- end -}}      
        <script>

        function switchTab(tab) {
          const navName = tab + "-nav"
          const dataName = tab
          const allElements = document.getElementsByClassName("feature-block--tab-data")
          for (let i=0; i < allElements.length; i++) {
            if (allElements[i].classList.contains("active")) {
              allElements[i].classList.remove("active");
            }
          }
          const allNavElements = document.getElementsByClassName("feature-block--nav")
          for (let i=0; i < allNavElements.length; i++) {
            if (allNavElements[i].classList.contains("active")) {
              allNavElements[i].classList.remove("active");
            }
          }
          const navElement = document.getElementById(navName)
          const dataElement = document.getElementById(dataName)
          dataElement.classList.add("active")
          navElement.classList.add("active")
        }
        </script>{{- end -}}
        {{- if eq .direction "ltr" -}}{{- with .visual -}}
        <div class="feature-block--illu illu-shadow--right">
          {{- partial "cloudinary/image" (dict "pg" $.pg "preset" "feature" "image" .permalink "alt" (.alt | default .permalink)) }}
        </div>
        {{- end -}}{{- end -}}
        {{- if eq .direction "vertical" -}}{{- with .visual -}}
        <div class="feature-block--illu illu-shadow--right">
          {{- partial "cloudinary/image" (dict "pg" $.pg "image" .permalink "alt" (.alt | default .permalink) "min_width" "320" "max_width" "4230" "steps" "15" "sizes" "100vw") }}
        </div>
        {{- end -}}{{- end -}}
      </div>
    </div>
    {{- if eq .class "section-deploy" -}}
      <div class="hosting-logos">
        <div class="container">
          <div class="hosting-logo">
            {{- partial "svg" (dict "id" "logos--aws" "height" "30") -}}
          </div>
          <div class="hosting-logo">
            {{- partial "svg" (dict "id" "logos--github-pages" "height" "24") -}}
          </div>
          <div class="hosting-logo">
            {{- partial "svg" (dict "id" "logos--netlify" "height" "34") -}}
          </div>
          <div class="hosting-logo">
            {{- partial "svg" (dict "id" "logos--ftp" "height" "18") -}}
          </div>
        </div>
        <div class="deploying-animation"></div>
      </div>
      {{- end -}}
  </section>
  {{- end -}}
{{- end -}}